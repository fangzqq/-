# Python语言特性

## Python的函数参数传递

一句话总结：

标准库里的 FAQ 说，在 Python 中，参数是通过赋值传递的（“arguments are passed by assignment”）。赋值会为对象创建一份新的引用。也就是说，函数内部的形参是实参（对象）的引用。这种方案的结果是,函数可能会修改作为参数传入的可变对象（如：list, dict, set）的值。而且因为函数内部的形参是一份新的引用, 所以当形参重新绑定之后将不再与最初传入的实参有任何关系。


展开论述：

在 Python 里所有的变量或参数，都可以理解为是对内存中一个对象的“引用”。要想理解 python 中的函数参数传递，首先需要理解 python 中的 object。在 python 中一切皆对象，每个对象都有：

1. 标识（identity）， 对象一旦创建后 id 就不会再改变
2. 类型（type），决定了这个对象支持的操作。类型一般也是不可变的
3. 值（value），根据对象的值是否可变，可将对象分为：
  - immutable object。对象一旦创建后，值就不可改变（numbers，strings， tuples)
  - mutable object, 对象在创建后，值可以改变（list，dict，set）

标准库里的 FAQ 说，在 Python中，参数是通过赋值传递的（arguments are passed by assignment），而赋值会为对象创建一份新的引用。也就是说，函数内部的形参是实参（对象）的引用。这种方案的结果是，函数可能会修改作为参数传入的可变对象（比如：list，dict，set）的值。而且因为函数内部的形参是一份新的引用, 所以当形参重新绑定之后将不再与最初传入的实参有任何关系。

这种函数传参方案还有一个问题，就是为函数设置默认参数时，要避免使用 _可变类型_ 作为参数的默认值。因为默认值是在定义函数时计算的（通常是在加载模块时），因此 _默认值就变成了函数对象的属性_。如果默认值是可变对象，而且修改了它的值，那么后续的函数调用都会受影响。解决方法是使用 `None` 作为接收可变值的参数的默认值。其实在类中也会有这样的问题，如果直接把参数赋值给实例变量，这相当于为参数对象创建了一份新的引用。解决方法是，当不确定时，就做一次 copy，为传入的对象创建副本。
